<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biskaken Auto Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background-color: #f9fafb;
        }
        /* Custom scrollbar for a cleaner UI */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex">
    <!-- SIDEBAR - ORANGE PANEL (EXACT COPY FROM REACT) -->
    <aside class="hidden lg:flex w-72 flex-col bg-white border-r border-gray-200 fixed h-full z-30 shadow-xl">
        <!-- Sidebar Header -->
        <div class="p-6 flex items-center gap-3 border-b border-gray-100">
            <div class="w-12 h-12 bg-gradient-to-br from-orange-500 to-red-500 rounded-xl flex items-center justify-center text-white font-bold text-xl shadow-lg">
                üîß
            </div>
            <div>
                <span class="text-xl font-bold text-gray-900 tracking-tight">BISKAKEN</span>
                <p class="text-xs text-gray-500 font-medium">Auto Repair Management</p>
            </div>
        </div>
        
        <!-- New Work Order Button -->
        <div class="px-4 py-6 border-b border-gray-100">
            <button onclick="window.location.href='/jobs'" class="w-full flex items-center gap-3 px-4 py-3 bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-xl hover:from-orange-600 hover:to-red-600 transition-all duration-200 shadow-lg hover:shadow-xl group">
                ‚ûï
                <span class="font-semibold">New Work Order</span>
            </button>
        </div>
        
        <!-- Navigation Menu -->
        <nav class="flex-1 px-4 py-6 space-y-2">
            <a href="/dashboard" class="group flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200 bg-gradient-to-r from-orange-500 to-red-500 text-white shadow-lg">
                üìä <span class="font-semibold text-sm">Dashboard</span>
            </a>
            <a href="/customers" class="group flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200 text-gray-700 hover:bg-gray-100 hover:text-orange-600">
                üöó <span class="font-semibold text-sm">Vehicles</span>
            </a>
            <a href="/jobs" class="group flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200 text-gray-700 hover:bg-gray-100 hover:text-orange-600">
                üîß <span class="font-semibold text-sm">Work Orders</span>
            </a>
            <a href="/inventory" class="group flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200 text-gray-700 hover:bg-gray-100 hover:text-orange-600">
                üì¶ <span class="font-semibold text-sm">Parts & Stock</span>
            </a>
            <a href="/invoices" class="group flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200 text-gray-700 hover:bg-gray-100 hover:text-orange-600">
                üí≥ <span class="font-semibold text-sm">Billing</span>
            </a>
            <a href="/blog" class="group flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200 text-gray-700 hover:bg-gray-100 hover:text-orange-600">
                üìñ <span class="font-semibold text-sm">Blog</span>
            </a>
            <a href="/reports" class="group flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200 text-gray-700 hover:bg-gray-100 hover:text-orange-600">
                üìä <span class="font-semibold text-sm">Reports</span>
            </a>
            <a href="/settings" class="group flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200 text-gray-700 hover:bg-gray-100 hover:text-orange-600">
                ‚öôÔ∏è <span class="font-semibold text-sm">Settings</span>
            </a>
        </nav>

        <!-- Logout Button -->
        <div class="p-4 border-t border-gray-100">
            <button onclick="window.location.href='/logout'" class="flex items-center gap-3 w-full px-4 py-3 text-red-600 hover:bg-red-50 rounded-xl transition-colors font-semibold text-sm">
                üö™ <span>Sign Out</span>
            </button>
        </div>
    </aside>

    <!-- MAIN CONTENT AREA -->
    <div class="flex-1 lg:ml-72 flex flex-col min-w-0">
        <!-- Top Header -->
        <header class="sticky top-0 z-20 bg-white/95 backdrop-blur-md border-b border-gray-200 h-20 flex items-center justify-between px-6 lg:px-8 shadow-sm">
            <div class="flex items-center gap-4">
                <div class="hidden lg:flex items-center gap-4">
                    <div class="relative">
                        üîç
                        <input type="text" placeholder="Search vehicles, customers, work orders..." 
                               class="w-80 pl-10 pr-4 py-2 border border-gray-200 rounded-xl bg-gray-50 focus:bg-white focus:border-orange-300 focus:ring-2 focus:ring-orange-100 transition-all">
                    </div>
                </div>
            </div>

            <div class="flex items-center gap-4">
                <!-- Notifications -->
                <button class="relative p-3 text-gray-500 hover:bg-gray-100 rounded-xl transition-colors">
                    üîî
                    <span class="absolute top-2 right-2 w-3 h-3 bg-red-500 rounded-full border-2 border-white"></span>
                </button>
                
                <!-- User Menu -->
                <div class="flex items-center gap-2 p-1 pl-2 hover:bg-gray-50 rounded-lg transition-colors border border-transparent hover:border-gray-200">
                    <div class="text-right">
                        <p class="text-sm font-semibold text-gray-900">{{ user.name if user and user.name else 'Admin User' }}</p>
                        <p class="text-xs text-gray-500 uppercase tracking-wider">{{ user.role if user and user.role else 'ADMIN' }}</p>
                    </div>
                    <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-700 font-bold uppercase">
                        {{ user.name[0] if user and user.name else 'A' }}
                    </div>
                </div>
            </div>
        </header>

        <!-- Dynamic Page Content - EXACT COPY OF REACT DashboardPageFixed -->
        <main class="flex-1 p-4 lg:p-8 overflow-x-hidden">
            <div class="space-y-6 p-6">
                <!-- Header with User Info and Quick Actions -->
                <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4">
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900">
                            Welcome back, {{ user.name if user and user.name else 'Admin' }}!
                        </h1>
                        <p class="text-gray-500">Here's what's happening at your auto shop today.</p>
                    </div>
                    
                    <!-- Quick Action Buttons -->
                    <div class="flex flex-col sm:flex-row gap-3">
                        <button onclick="window.location.href='/landing'" 
                                class="bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 flex items-center gap-2 transition-colors">
                            üè† Go to Homepage
                        </button>
                        <button onclick="window.location.href='/jobs'" 
                                class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2 transition-colors">
                            ‚ûï New Work Order
                        </button>
                        <button onclick="refreshData()" 
                                class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 flex items-center gap-2 transition-colors">
                            üîÑ Refresh
                        </button>
                    </div>
                </div>

                <!-- Stats Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border hover:shadow-md transition-shadow">
                        <div class="flex justify-between">
                            <div>
                                <p class="text-sm font-medium text-gray-500">Total Revenue</p>
                                <h3 class="text-2xl font-bold mt-1 text-gray-900">‚Çµ{{ stats.totalRevenue if stats else '15,750.00' }}</h3>
                                <p class="text-xs mt-1 font-medium text-emerald-600">
                                    +12.5% <span class="text-gray-400 ml-1">from last month</span>
                                </p>
                            </div>
                            <div class="p-3 rounded-xl bg-emerald-500 bg-opacity-10 text-emerald-600">
                                üìà
                            </div>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-sm border hover:shadow-md transition-shadow">
                        <div class="flex justify-between">
                            <div>
                                <p class="text-sm font-medium text-gray-500">Active Jobs</p>
                                <h3 class="text-2xl font-bold mt-1 text-gray-900">{{ stats.pendingJobs if stats else '5' }}</h3>
                                <p class="text-xs mt-1 font-medium text-blue-600">
                                    +8.2% <span class="text-gray-400 ml-1">from last month</span>
                                </p>
                            </div>
                            <div class="p-3 rounded-xl bg-blue-500 bg-opacity-10 text-blue-600">
                                üöó
                            </div>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-sm border hover:shadow-md transition-shadow">
                        <div class="flex justify-between">
                            <div>
                                <p class="text-sm font-medium text-gray-500">Completed Jobs</p>
                                <h3 class="text-2xl font-bold mt-1 text-gray-900">{{ stats.completedJobs if stats else '28' }}</h3>
                                <p class="text-xs mt-1 font-medium text-green-600">
                                    +15.3% <span class="text-gray-400 ml-1">from last month</span>
                                </p>
                            </div>
                            <div class="p-3 rounded-xl bg-green-500 bg-opacity-10 text-green-600">
                                ‚úÖ
                            </div>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-sm border hover:shadow-md transition-shadow">
                        <div class="flex justify-between">
                            <div>
                                <p class="text-sm font-medium text-gray-500">Total Customers</p>
                                <h3 class="text-2xl font-bold mt-1 text-gray-900">{{ stats.totalCustomers if stats else '156' }}</h3>
                                <p class="text-xs mt-1 font-medium text-purple-600">
                                    +5.7% <span class="text-gray-400 ml-1">from last month</span>
                                </p>
                            </div>
                            <div class="p-3 rounded-xl bg-purple-500 bg-opacity-10 text-purple-600">
                                üë•
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charts and Quick Info -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Revenue Chart -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Weekly Revenue</h3>
                        <div style="width: 100%; height: 300px;">
                            <canvas id="revenueChart"></canvas>
                        </div>
                    </div>

                    <!-- Recent Activities -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-semibold text-gray-900">Recent Work Orders</h3>
                            <span class="text-sm text-gray-500">{{ recent_jobs|length if recent_jobs else '3' }} active</span>
                        </div>
                        <div class="space-y-3">
                            {% if recent_jobs %}
                                {% for job in recent_jobs %}
                                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-3 h-3 rounded-full bg-blue-500"></div>
                                        <div>
                                            <p class="font-medium text-gray-900">{{ job.customerName or 'Customer' }}</p>
                                            <p class="text-sm text-gray-500">{{ job.vehicleInfo or 'Service' }}</p>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                            {{ job.status or 'PENDING' }}
                                        </span>
                                        <p class="text-sm text-gray-500 mt-1">‚Çµ{{ job.estimatedCost or '450' }}</p>
                                    </div>
                                </div>
                                {% endfor %}
                            {% else %}
                            <div class="text-center py-8 text-gray-500">
                                üöó
                                <p class="mt-2">No recent work orders</p>
                                <button onclick="window.location.href='/jobs'" 
                                        class="text-blue-600 hover:text-blue-700 text-sm mt-1">
                                    Create your first job
                                </button>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- System Status -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- System Health -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">System Status</h3>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-600">Database</span>
                                <span class="flex items-center text-green-600">
                                    ‚úÖ Connected
                                </span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-600">API Services</span>
                                <span class="flex items-center text-green-600">
                                    ‚úÖ Active
                                </span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-600">Mobile Money</span>
                                <span class="flex items-center text-yellow-600">
                                    üïí Testing
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- Mobile Money Test Component -->
                    <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">üí∞ Mobile Money Test</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div class="p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                                <p class="font-medium text-yellow-800 mb-2">üîß Payment System Ready</p>
                                <p class="text-sm text-yellow-700">Ghana Mobile Money integration configured</p>
                            </div>
                            <div class="space-y-2">
                                <button onclick="testMTN()" 
                                        class="w-full bg-yellow-500 text-white py-2 px-4 rounded-lg hover:bg-yellow-600 transition-colors text-sm font-medium">
                                    Test MTN MoMo
                                </button>
                                <button onclick="testVodafone()" 
                                        class="w-full bg-red-500 text-white py-2 px-4 rounded-lg hover:bg-red-600 transition-colors text-sm font-medium">
                                    Test Vodafone Cash
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AI Assistant Section - EXACT COPY FROM REACT localhost:3000 -->
                <div class="bg-gradient-to-br from-purple-600 via-blue-600 to-teal-500 p-8 rounded-2xl text-white shadow-xl border border-purple-200">
                    <div class="text-center mb-6">
                        <h2 class="text-3xl font-bold mb-2 flex items-center justify-center gap-3">
                            <span class="text-yellow-300 text-2xl">‚ú®</span>
                            üöÄ V4 AI Assistant - Let AI Help Your Business!
                            <span class="text-yellow-300 text-2xl">‚ú®</span>
                        </h2>
                        <p class="text-purple-100 text-lg">Perfect for non-technical users - Just click and AI does the work!</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4">
                        <button onclick="generateTitle()" 
                                class="h-20 bg-gradient-to-r from-pink-500 to-rose-500 hover:from-pink-600 hover:to-rose-600 text-white border-0 shadow-lg transform hover:scale-105 transition-all duration-200 rounded-lg">
                            <div class="text-center">
                                <span class="text-2xl block mb-1">‚úèÔ∏è</span>
                                <div class="text-sm font-bold">‚ú® Create Title</div>
                                <div class="text-xs opacity-90">AI writes titles</div>
                            </div>
                        </button>
                        
                        <button onclick="generateSummary()" 
                                class="h-20 bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white border-0 shadow-lg transform hover:scale-105 transition-all duration-200 rounded-lg">
                            <div class="text-center">
                                <span class="text-2xl block mb-1">üß†</span>
                                <div class="text-sm font-bold">üß† Create Summary</div>
                                <div class="text-xs opacity-90">AI writes excerpts</div>
                            </div>
                        </button>
                        
                        <button onclick="generateArticle()" 
                                class="h-20 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white border-0 shadow-lg transform hover:scale-105 transition-all duration-200 rounded-lg">
                            <div class="text-center">
                                <span class="text-2xl block mb-1">üìù</span>
                                <div class="text-sm font-bold">üìù Write Article</div>
                                <div class="text-xs opacity-90">AI writes full posts</div>
                            </div>
                        </button>
                        
                        <button onclick="generateImage()" 
                                class="h-20 bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white border-0 shadow-lg transform hover:scale-105 transition-all duration-200 rounded-lg">
                            <div class="text-center">
                                <span class="text-2xl block mb-1">üñºÔ∏è</span>
                                <div class="text-sm font-bold">üñºÔ∏è Create Image</div>
                                <div class="text-xs opacity-90">AI generates photos</div>
                            </div>
                        </button>
                        
                        <button onclick="uploadImage()" 
                                class="h-20 bg-gradient-to-r from-purple-500 to-indigo-500 hover:from-purple-600 hover:to-indigo-600 text-white border-0 shadow-lg transform hover:scale-105 transition-all duration-200 rounded-lg">
                            <div class="text-center">
                                <span class="text-2xl block mb-1">üì∑</span>
                                <div class="text-sm font-bold">üì∑ Upload Image</div>
                                <div class="text-xs opacity-90">Add your photos</div>
                            </div>
                        </button>
                        
                        <button onclick="uploadVideo()" 
                                class="h-20 bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white border-0 shadow-lg transform hover:scale-105 transition-all duration-200 rounded-lg">
                            <div class="text-center">
                                <span class="text-2xl block mb-1">üé•</span>
                                <div class="text-sm font-bold">üé• Upload Video</div>
                                <div class="text-xs opacity-90">Add your videos</div>
                            </div>
                        </button>
                    </div>
                    
                    <div class="text-center mt-6">
                        <p class="text-purple-100 text-sm">
                            üí° <strong>No technical skills needed!</strong> Just click any button above and AI will help you create amazing content for your auto shop.
                        </p>
                    </div>
                </div>

                <!-- AI Business Insights (EXACT COPY FROM REACT) -->
                <div class="bg-gradient-to-r from-purple-50 to-blue-50 p-6 rounded-xl border">
                    <div class="flex items-center space-x-3 mb-4">
                        <div class="p-2 bg-purple-100 rounded-lg">
                            ‚ú®
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900">AI Business Insights</h3>
                            <p class="text-sm text-gray-600">Powered by advanced analytics</p>
                        </div>
                    </div>
                    <div class="bg-white p-4 rounded-lg">
                        <p class="text-gray-700">
                            üìà Your shop is performing well this week! Revenue is up 12.5% compared to last month. 
                            Consider focusing on brake services as they show the highest profit margins. 
                            The busy period on Saturday suggests weekend promotions could boost revenue further.
                        </p>
                        <div class="mt-3 flex items-center justify-between">
                            <span class="text-xs text-gray-500">Last updated: Just now</span>
                            <button onclick="refreshData()" class="text-purple-600 hover:text-purple-700 text-sm">
                                Refresh insights
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Revenue Chart with EXACT styling from React
        const ctx = document.getElementById('revenueChart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                datasets: [{
                    label: 'Revenue',
                    data: [1200, 1900, 1500, 2400, 1800, 3200, 900],
                    borderColor: '#3B82F6',
                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: '#3B82F6',
                    pointBorderColor: '#3B82F6',
                    pointRadius: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: '#f3f4f6'
                        },
                        ticks: {
                            callback: function(value) {
                                return '‚Çµ' + value;
                            }
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                },
                interaction: {
                    intersect: false
                }
            }
        });

        // Functions matching React functionality
        function refreshData() {
            console.log('Refreshing data...');
            window.location.reload();
        }

        function testMTN() {
            alert('MTN Mobile Money test initiated');
        }

        function testVodafone() {
            alert('Vodafone Cash test initiated');
        }

        // AI Assistant Functions
        async function generateTitle() {
            try {
                const topic = prompt('What topic do you want to create a title for?') || 'car maintenance';
                const response = await fetch('/api/ai/generate-title', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ topic })
                });
                const result = await response.json();
                if (result.success) {
                    alert('Generated Title: ' + result.data.title);
                } else {
                    alert('Failed to generate title. Please try again.');
                }
            } catch (error) {
                alert('Error generating title: ' + error.message);
            }
        }

        async function generateSummary() {
            try {
                const content = prompt('Enter content to summarize:') || 'brake system maintenance';
                const response = await fetch('/api/ai/generate-summary', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ content })
                });
                const result = await response.json();
                if (result.success) {
                    alert('Generated Summary: ' + result.data.summary);
                } else {
                    alert('Failed to generate summary. Please try again.');
                }
            } catch (error) {
                alert('Error generating summary: ' + error.message);
            }
        }

        async function generateArticle() {
            try {
                const title = prompt('Enter article title:') || 'Car Maintenance Tips';
                const topic = prompt('Enter topic:') || 'general maintenance';
                const response = await fetch('/api/ai/generate-article', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ title, topic })
                });
                const result = await response.json();
                if (result.success) {
                    // Create a new window to show the article
                    const newWindow = window.open('', '_blank');
                    newWindow.document.write(`
                        <html>
                        <head><title>${result.data.title}</title>
                        <style>body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }</style>
                        </head>
                        <body>
                        <h1>${result.data.title}</h1>
                        <p><strong>Word Count:</strong> ${result.data.word_count}</p>
                        <hr>
                        ${result.data.content}
                        </body></html>
                    `);
                    newWindow.document.close();
                } else {
                    alert('Failed to generate article. Please try again.');
                }
            } catch (error) {
                alert('Error generating article: ' + error.message);
            }
        }

        async function generateImage() {
            try {
                const description = prompt('Describe the image you want to generate:') || 'auto repair shop';
                const response = await fetch('/api/ai/generate-image', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ description })
                });
                const result = await response.json();
                if (result.success) {
                    // Show image in new window
                    const newWindow = window.open('', '_blank');
                    newWindow.document.write(`
                        <html>
                        <head><title>Generated Image</title>
                        <style>body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }</style>
                        </head>
                        <body>
                        <h2>AI Generated Image</h2>
                        <p><strong>Description:</strong> ${description}</p>
                        <img src="${result.data.image_url}" alt="${result.data.alt_text}" style="max-width: 100%; height: auto;">
                        </body></html>
                    `);
                    newWindow.document.close();
                } else {
                    alert('Failed to generate image. Please try again.');
                }
            } catch (error) {
                alert('Error generating image: ' + error.message);
            }
        }

        async function uploadImage() {
            try {
                const filename = prompt('Enter image filename:') || 'my-image.jpg';
                const response = await fetch('/api/ai/upload-image', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ filename })
                });
                const result = await response.json();
                if (result.success) {
                    alert(`Image uploaded successfully!\nFilename: ${result.data.filename}\nSize: ${result.data.size}\nURL: ${result.data.uploaded_url}`);
                } else {
                    alert('Failed to upload image. Please try again.');
                }
            } catch (error) {
                alert('Error uploading image: ' + error.message);
            }
        }

        async function uploadVideo() {
            try {
                const filename = prompt('Enter video filename:') || 'my-video.mp4';
                const response = await fetch('/api/ai/upload-video', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ filename })
                });
                const result = await response.json();
                if (result.success) {
                    alert(`Video uploaded successfully!\nFilename: ${result.data.filename}\nSize: ${result.data.size}\nDuration: ${result.data.duration}\nURL: ${result.data.uploaded_url}`);
                } else {
                    alert('Failed to upload video. Please try again.');
                }
            } catch (error) {
                alert('Error uploading video: ' + error.message);
            }
        }
    </script>
</body>
</html>