<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vehicles - Biskaken Auto</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', system-ui, -apple-system, sans-serif; }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex">
    <!-- LEFT SIDEBAR - ORANGE PANEL -->
    <aside class="hidden lg:flex w-72 flex-col bg-white border-r border-gray-200 fixed h-full z-30 shadow-xl">
        <!-- Sidebar Header -->
        <div class="p-6 flex items-center gap-3 border-b border-gray-100">
            <div class="w-12 h-12 bg-gradient-to-br from-orange-500 to-red-500 rounded-xl flex items-center justify-center text-white font-bold text-xl shadow-lg">ğŸ”§</div>
            <div>
                <span class="text-xl font-bold text-gray-900 tracking-tight">BISKAKEN</span>
                <p class="text-xs text-gray-500 font-medium">Auto Repair Management</p>
            </div>
        </div>
        
        <!-- New Work Order Button -->
        <div class="px-4 py-6 border-b border-gray-100">
            <button onclick="window.location.href='/jobs'" class="w-full flex items-center gap-3 px-4 py-3 bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-xl hover:from-orange-600 hover:to-red-600 transition-all duration-200 shadow-lg hover:shadow-xl group">
                â• <span class="font-semibold">New Work Order</span>
            </button>
        </div>
        
        <!-- Navigation Menu -->
        <nav class="flex-1 px-4 py-6 space-y-2">
            <a href="/dashboard" class="group flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200 text-gray-700 hover:bg-gray-100 hover:text-orange-600">
                ğŸ“Š <span class="font-semibold text-sm">Dashboard</span>
            </a>
            <a href="/customers" class="group flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200 bg-gradient-to-r from-orange-500 to-red-500 text-white shadow-lg">
                ğŸš— <span class="font-semibold text-sm">Vehicles</span>
            </a>
            <a href="/jobs" class="group flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200 text-gray-700 hover:bg-gray-100 hover:text-orange-600">
                ğŸ”§ <span class="font-semibold text-sm">Work Orders</span>
            </a>
            <a href="/inventory" class="group flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200 text-gray-700 hover:bg-gray-100 hover:text-orange-600">
                ğŸ“¦ <span class="font-semibold text-sm">Parts & Stock</span>
            </a>
            <a href="/invoices" class="group flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200 text-gray-700 hover:bg-gray-100 hover:text-orange-600">
                ğŸ’³ <span class="font-semibold text-sm">Billing</span>
            </a>
            <a href="/blog" class="group flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200 text-gray-700 hover:bg-gray-100 hover:text-orange-600">
                ğŸ“– <span class="font-semibold text-sm">Blog</span>
            </a>
            <a href="/reports" class="group flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200 text-gray-700 hover:bg-gray-100 hover:text-orange-600">
                ğŸ“Š <span class="font-semibold text-sm">Reports</span>
            </a>
            <a href="/settings" class="group flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200 text-gray-700 hover:bg-gray-100 hover:text-orange-600">
                âš™ï¸ <span class="font-semibold text-sm">Settings</span>
            </a>
        </nav>

        <!-- Logout Button -->
        <div class="p-4 border-t border-gray-100">
            <button onclick="window.location.href='/logout'" class="flex items-center gap-3 w-full px-4 py-3 text-red-600 hover:bg-red-50 rounded-xl transition-colors font-semibold text-sm">
                ğŸšª <span>Sign Out</span>
            </button>
        </div>
    </aside>

    <!-- MAIN CONTENT AREA -->
    <div class="flex-1 lg:ml-72 flex flex-col min-w-0">
        <!-- Top Header -->
        <header class="sticky top-0 z-20 bg-white/95 backdrop-blur-md border-b border-gray-200 h-20 flex items-center justify-between px-6 lg:px-8 shadow-sm">
            <div class="flex items-center gap-4">
                <h1 class="text-2xl font-bold text-gray-900">Vehicles & Customers</h1>
            </div>
            <div class="flex items-center gap-4">
                <button onclick="openCustomerModal()" class="px-6 py-3 bg-orange-500 text-white rounded-xl font-medium hover:bg-orange-600 transition-all">
                    â• Add Customer
                </button>
            </div>
        </header>

        <!-- Dynamic Page Content -->
        <main class="flex-1 p-4 lg:p-8 overflow-x-hidden">
            <!-- Search and Stats -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                <div class="bg-white p-6 rounded-xl shadow-sm border">
                    <div class="flex items-center gap-3">
                        <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center text-blue-600">ğŸ‘¥</div>
                        <div>
                            <p class="text-sm text-gray-600">Total Customers</p>
                            <p class="text-2xl font-bold text-gray-900" id="totalCustomers">0</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-sm border">
                    <div class="flex items-center gap-3">
                        <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center text-green-600">ğŸš—</div>
                        <div>
                            <p class="text-sm text-gray-600">Active Vehicles</p>
                            <p class="text-2xl font-bold text-gray-900" id="activeVehicles">0</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-sm border">
                    <div class="flex items-center gap-3">
                        <div class="w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center text-orange-600">ğŸ“</div>
                        <div>
                            <p class="text-sm text-gray-600">This Month</p>
                            <p class="text-2xl font-bold text-gray-900">15</p>
                        </div>
                    </div>
                </div>
                <div class="md:col-span-1">
                    <div class="relative">
                        <input type="text" id="searchInput" placeholder="Search customers, vehicles..." 
                               class="w-full pl-4 pr-10 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
                        <div class="absolute right-3 top-3.5 text-gray-400">ğŸ”</div>
                    </div>
                </div>
            </div>

            <!-- Customers List -->
            <div class="bg-white rounded-xl shadow-sm border">
                <div class="p-6 border-b border-gray-200">
                    <h2 class="text-lg font-bold text-gray-900">Customer Database</h2>
                </div>
                <div id="customersList" class="divide-y divide-gray-200">
                    <!-- Customers will be populated by JavaScript -->
                </div>
            </div>
        </main>
    </div>

    <!-- Customer Modal -->
    <div id="customerModal" class="fixed inset-0 bg-black/50 hidden flex items-center justify-center z-50">
        <div class="bg-white p-6 rounded-xl max-w-md w-full mx-4">
            <h3 class="text-lg font-bold mb-4" id="modalTitle">Add New Customer</h3>
            <form id="customerForm" class="space-y-4">
                <input type="hidden" id="customerId">
                <input type="text" id="customerName" placeholder="Customer Name" required class="w-full p-3 border rounded-xl">
                <input type="email" id="customerEmail" placeholder="Email Address" class="w-full p-3 border rounded-xl">
                <input type="tel" id="customerPhone" placeholder="Phone Number" class="w-full p-3 border rounded-xl">
                <input type="text" id="plateNumber" placeholder="License Plate" class="w-full p-3 border rounded-xl">
                <input type="text" id="vehicleMake" placeholder="Vehicle Make (e.g., Toyota)" class="w-full p-3 border rounded-xl">
                <input type="text" id="vehicleModel" placeholder="Vehicle Model (e.g., Camry)" class="w-full p-3 border rounded-xl">
                <input type="number" id="vehicleYear" placeholder="Vehicle Year" min="1990" max="2025" class="w-full p-3 border rounded-xl">
                <textarea id="customerAddress" placeholder="Address" rows="2" class="w-full p-3 border rounded-xl"></textarea>
            </form>
            <div class="flex gap-3 mt-6">
                <button onclick="closeCustomerModal()" class="flex-1 py-3 bg-gray-200 text-gray-700 rounded-xl font-medium">Cancel</button>
                <button onclick="saveCustomer()" class="flex-1 py-3 bg-orange-500 text-white rounded-xl font-medium">Save Customer</button>
            </div>
        </div>
    </div>

    <script>
        // Test data
        const testCustomers = [
            {
                id: 'C001',
                name: 'Kwame Asante',
                email: 'kwame@example.com',
                phone: '+233 24 123 4567',
                address: 'Accra, Ghana',
                plateNumber: 'GR 1234-20',
                vehicleMake: 'Toyota',
                vehicleModel: 'Camry',
                vehicleYear: 2018,
                lastService: '2023-12-15',
                totalJobs: 3
            },
            {
                id: 'C002',
                name: 'Akosua Mensah',
                email: 'akosua@example.com',
                phone: '+233 20 987 6543',
                address: 'Kumasi, Ghana',
                plateNumber: 'AS 5678-21',
                vehicleMake: 'Honda',
                vehicleModel: 'Civic',
                vehicleYear: 2020,
                lastService: '2024-01-10',
                totalJobs: 2
            },
            {
                id: 'C003',
                name: 'Kojo Osei',
                email: 'kojo@example.com',
                phone: '+233 26 456 7890',
                address: 'Tamale, Ghana',
                plateNumber: 'NR 9012-19',
                vehicleMake: 'Nissan',
                vehicleModel: 'Sentra',
                vehicleYear: 2019,
                lastService: '2024-01-05',
                totalJobs: 1
            }
        ];

        let currentCustomers = [...testCustomers];
        let editingCustomerId = null;

        function openCustomerModal(customer = null) {
            document.getElementById('customerModal').classList.remove('hidden');
            
            if (customer) {
                // Edit mode
                editingCustomerId = customer.id;
                document.getElementById('modalTitle').textContent = 'Edit Customer';
                document.getElementById('customerId').value = customer.id;
                document.getElementById('customerName').value = customer.name;
                document.getElementById('customerEmail').value = customer.email;
                document.getElementById('customerPhone').value = customer.phone;
                document.getElementById('plateNumber').value = customer.plateNumber;
                document.getElementById('vehicleMake').value = customer.vehicleMake;
                document.getElementById('vehicleModel').value = customer.vehicleModel;
                document.getElementById('vehicleYear').value = customer.vehicleYear;
                document.getElementById('customerAddress').value = customer.address;
            } else {
                // Add mode
                editingCustomerId = null;
                document.getElementById('modalTitle').textContent = 'Add New Customer';
                document.getElementById('customerForm').reset();
            }
        }

        function closeCustomerModal() {
            document.getElementById('customerModal').classList.add('hidden');
            document.getElementById('customerForm').reset();
            editingCustomerId = null;
        }

        function saveCustomer() {
            const formData = {
                name: document.getElementById('customerName').value,
                email: document.getElementById('customerEmail').value,
                phone: document.getElementById('customerPhone').value,
                address: document.getElementById('customerAddress').value,
                plateNumber: document.getElementById('plateNumber').value,
                vehicleMake: document.getElementById('vehicleMake').value,
                vehicleModel: document.getElementById('vehicleModel').value,
                vehicleYear: parseInt(document.getElementById('vehicleYear').value) || null
            };

            if (!formData.name) {
                alert('Customer name is required');
                return;
            }

            if (editingCustomerId) {
                // Update existing customer
                const customerIndex = currentCustomers.findIndex(c => c.id === editingCustomerId);
                if (customerIndex !== -1) {
                    currentCustomers[customerIndex] = {
                        ...currentCustomers[customerIndex],
                        ...formData
                    };
                    showNotification('âœ… Customer updated successfully!');
                }
            } else {
                // Add new customer
                const newCustomer = {
                    id: 'C' + String(Math.floor(Math.random() * 1000)).padStart(3, '0'),
                    ...formData,
                    lastService: null,
                    totalJobs: 0
                };
                currentCustomers.unshift(newCustomer);
                showNotification('âœ… Customer added successfully!');
            }

            closeCustomerModal();
            renderCustomers();
            updateStats();
        }

        function deleteCustomer(customerId) {
            if (confirm('Are you sure you want to delete this customer? This action cannot be undone.')) {
                currentCustomers = currentCustomers.filter(c => c.id !== customerId);
                renderCustomers();
                updateStats();
                showNotification('âœ… Customer deleted successfully!');
            }
        }

        function createJobForCustomer(customer) {
            showNotification(`ğŸš— Creating new job for ${customer.name}...`);
            // In a real app, this would redirect to job creation with pre-filled customer data
            setTimeout(() => {
                window.location.href = '/jobs';
            }, 1000);
        }

        function renderCustomers() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const filteredCustomers = currentCustomers.filter(customer => {
                return customer.name.toLowerCase().includes(searchTerm) ||
                       customer.email.toLowerCase().includes(searchTerm) ||
                       customer.phone.toLowerCase().includes(searchTerm) ||
                       customer.plateNumber.toLowerCase().includes(searchTerm) ||
                       customer.vehicleMake.toLowerCase().includes(searchTerm) ||
                       customer.vehicleModel.toLowerCase().includes(searchTerm);
            });

            const customersList = document.getElementById('customersList');
            
            if (filteredCustomers.length === 0) {
                customersList.innerHTML = `
                    <div class="text-center py-12">
                        <div class="text-6xl mb-4">ğŸ‘¥</div>
                        <h3 class="text-xl font-bold text-gray-600 mb-2">No customers found</h3>
                        <p class="text-gray-500 mb-4">Add your first customer to get started</p>
                        <button onclick="openCustomerModal()" class="px-6 py-3 bg-orange-500 text-white rounded-xl font-medium hover:bg-orange-600">
                            Add Customer
                        </button>
                    </div>
                `;
                return;
            }

            customersList.innerHTML = filteredCustomers.map(customer => `
                <div class="p-6 hover:bg-gray-50 transition-colors">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <div class="flex items-center gap-4 mb-3">
                                <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-500 rounded-xl flex items-center justify-center text-white font-bold text-lg">
                                    ${customer.name.charAt(0).toUpperCase()}
                                </div>
                                <div>
                                    <h3 class="text-lg font-bold text-gray-900">${customer.name}</h3>
                                    <p class="text-gray-600">${customer.vehicleMake} ${customer.vehicleModel} ${customer.vehicleYear || ''}</p>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                                <div>
                                    <span class="text-gray-500">ğŸ“§ Email:</span>
                                    <p class="font-medium">${customer.email || 'Not provided'}</p>
                                </div>
                                <div>
                                    <span class="text-gray-500">ğŸ“ Phone:</span>
                                    <p class="font-medium">${customer.phone || 'Not provided'}</p>
                                </div>
                                <div>
                                    <span class="text-gray-500">ğŸš— Plate:</span>
                                    <p class="font-medium">${customer.plateNumber || 'Not provided'}</p>
                                </div>
                                <div>
                                    <span class="text-gray-500">ğŸ“ Address:</span>
                                    <p class="font-medium">${customer.address || 'Not provided'}</p>
                                </div>
                                <div>
                                    <span class="text-gray-500">ğŸ”§ Jobs:</span>
                                    <p class="font-medium">${customer.totalJobs} completed</p>
                                </div>
                                <div>
                                    <span class="text-gray-500">ğŸ“… Last Service:</span>
                                    <p class="font-medium">${customer.lastService || 'Never'}</p>
                                </div>
                            </div>
                        </div>
                        <div class="flex gap-2 ml-4">
                            <button onclick="createJobForCustomer({id: '${customer.id}', name: '${customer.name}'})" 
                                    class="px-3 py-2 bg-green-500 text-white rounded-lg text-sm font-medium hover:bg-green-600">
                                ğŸ”§ New Job
                            </button>
                            <button onclick="openCustomerModal({id: '${customer.id}', name: '${customer.name}', email: '${customer.email}', phone: '${customer.phone}', address: '${customer.address}', plateNumber: '${customer.plateNumber}', vehicleMake: '${customer.vehicleMake}', vehicleModel: '${customer.vehicleModel}', vehicleYear: ${customer.vehicleYear}})" 
                                    class="px-3 py-2 bg-blue-500 text-white rounded-lg text-sm font-medium hover:bg-blue-600">
                                âœï¸ Edit
                            </button>
                            <button onclick="deleteCustomer('${customer.id}')" 
                                    class="px-3 py-2 bg-red-500 text-white rounded-lg text-sm font-medium hover:bg-red-600">
                                ğŸ—‘ï¸ Delete
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function updateStats() {
            document.getElementById('totalCustomers').textContent = currentCustomers.length;
            document.getElementById('activeVehicles').textContent = currentCustomers.filter(c => c.vehicleMake).length;
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Initialize search functionality
        document.getElementById('searchInput').addEventListener('input', renderCustomers);

        // Initial render
        renderCustomers();
        updateStats();
    </script>
</body>
</html>